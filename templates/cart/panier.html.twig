{% extends 'base.html.twig' %}

{% block body %}

    <body class="inner-page">
    <div id="page">
    {% include'components/nav.html.twig' %}

    <section class="main-container col1-layout">
            <div class="main container">
                <div class="col-main">
                    <div class="cart">
                        <div class="page-title">
                            <h1>Votre panier</h1>
                        </div>
                        {% if items | length > 0 %}
                            <table class="table">
                                <thread>
                                    <tr>
                                        <th>Produit</th>
                                        <th>Prix</th>
                                        <th>Quantité</th>
                                        <th>Total</th>
                                        <th></th>
                                    </tr>
                                </thread>

                                <tbody>
                                    {% for item in items %}
                                        <tr>
                                            <td>{{ item.product.name }}</td>
                                            <td>{{ item.product.pricedisplay}}<span>€</span></td>
                                            <td>{{ item.quantity }}</td>
                                            <td>{{ (item.product.pricedisplay * item.quantity)}}<span>€</span></td>
                                            <td>
                                                <a href="{{ path('cart_remove', {'id': item.product.id}) }}" class="btn btn-danger btn-sm"> <i class="fas fa-trash"></i></a>

                                            </td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                                <tfoot>
                                <tr>
                                    <td colspan="3" class="text-right">Total :
                                    </td>
                                    <td>{{ total}}<span>€</span></td>
                                    <td></td>
                                </tr>
                                </tfoot>
                            </table>
                             <button id="checkout-button" class="button btn-cart">Paiement</button>


                        {% else %}
                            <p> Votre panier est vide</p>

                        {% endif %}


                        {#<div class="table-responsive">
                            <form method="post" action="#">
                                <fieldset>
                                    <table class="data-table cart-table" id="shopping-cart-table">
                                        <thead>
                                        <tr class="first last">
                                            <th rowspan="1">&nbsp;</th>
                                            <th rowspan="1"><span class="nobr">Nom du produit</span></th>
                                            <th rowspan="1" class="hidden-phone"></th>

                                            <th colspan="1" class="a-center"><span class="nobr">Prix unitaire</span></th>
                                            <th class="a-center " rowspan="1">Qté</th>
                                            <th colspan="1" class="a-center">Prix total</th>
                                            <th class="a-center" rowspan="1">&nbsp;</th>
                                        </tr>
                                        </thead>
                                        <tfoot>
                                        <tr class="first last">
                                            <td class="a-right last" colspan="50"><button onclick="#" class="button btn-continue" title="Continue Shopping" type="button"><span>Continuer vos achats</span></button>


                                        </tr>
                                        </tfoot>
                                        <tbody>
                                        <tr class="first odd">
                                            <td class="image"><a class="product-image" title="" href="#"><img width="75" height="75" alt="" src="products-images/product.jpg"></a></td>
                                            <td><h2 class="product-name"> <a href="#"></a> </h2></td>
                                            <td class="a-center hidden-table"><a title="Edit item parameters" class="edit-bnt" href="#"></a></td>

                                            <td class="a-center hidden-table"><span class="cart-price"> <span class="price"></span> </span></td>
                                            <td class="a-center movewishlist"><input maxlength="12" class="input-text qty" title="Qty" size="4" value="1" name=""></td>
                                            <td class="a-center movewishlist"><span class="cart-price"> <span class="price"></span> </span></td>
                                            <td class="a-center last"><a class="button remove-item" title="Remove item" href="#"><span><span>Supprimer l'article</span></span></a></td>
                                        </tr>
                                        <tr class="last even">
                                            <td class="image"><a class="product-image" title="" href="#"><img width="75" height="75" alt="" src="products-images/product.jpg"></a></td>
                                            <td><h2 class="product-name"> <a href="#"></a> </h2></td>
                                            <td class="a-center hidden-table"><a title="Edit item parameters" class="edit-bnt" href="#"></a></td>

                                            <td class="a-center hidden-table"><span class="cart-price"> <span class="price"></span> </span></td>
                                            <td class="a-center movewishlist"><input maxlength="12" class="input-text qty" title="Qty" size="4" value="1" name=""></td>
                                            <td class="a-center movewishlist"><span class="cart-price"> <span class="price"></span> </span></td>
                                            <td class="a-center last"><a class="button remove-item" title="Remove item" href="#"><span><span>supprimer l'article</span></span></a></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </fieldset>
                            </form>
                        </div>


                            <div class="col-sm-4">
                                <div class="totals">
                                    <h3>Shopping Cart Total</h3>
                                    <div class="inner">
                                        <table class="table shopping-cart-table-total" id="shopping-cart-totals-table">
                                            <colgroup>
                                                <col>
                                                <col width="1">
                                            </colgroup>
                                            <tfoot>
                                            <tr>
                                                <td colspan="1" class="a-left"><strong>Grand Total</strong></td>
                                                <td class="a-right"><strong><span class="price"></span></strong></td>
                                            </tr>
                                            </tfoot>
                                            <tbody>
                                            <tr>
                                                <td colspan="1" class="a-left"> Subtotal </td>
                                                <td class="a-right"><span class="price"></span></td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <ul class="checkout">
                                            <li>
                                                <button class="button btn-proceed-checkout" title="Proceed to Checkout" type="button"><span>Proceder à l'achat</span></button>
                                            </li>
                                            <br>

                                            <br>
                                        </ul>
                                    </div>
                                </div>
                                <!--inner-->

                            </div>
                        </div>

                        <!--cart-collaterals-->
#}
                    </div>
                </div>
            </div>
        </section>
    <br>
    <br>
    <br>
    <br>


{% endblock %}
        {% block javascripts %}
        {{ parent() }}
        <script src="https://js.stripe.com/v2/"></script>
            <script type="text/javascript">
                // Create an instance of the Stripe object with your publishable API key
                var stripe = Stripe('pk_test_51HhyDnBt4PlsSGAOJMnJrCMIRD1nripD28fb7a8JSFtwMHOXmpXT5I0UDbgtUMMrwZEUFJAiJCyuUNdJ3qhF3l3100QtU6lsfK');
                var checkoutButton = document.getElementById('checkout-button');

                checkoutButton.addEventListener('click', function() {
                    // Create a new Checkout Session using the server-side endpoint you
                    // created in step 3.
                    fetch('/create-checkout-session', {
                        method: 'POST',
                    })
                        .then(function(response) {
                            return response.json();
                        })
                        .then(function(session) {
                            return stripe.redirectToCheckout({ sessionId: session.id });
                        })
                        .then(function(result) {
                            // If `redirectToCheckout` fails due to a browser or network
                            // error, you should display the localized error message to your
                            // customer using `error.message`.
                            if (result.error) {
                                alert(result.error.message);
                            }
                        })
                        .catch(function(error) {
                            console.error('Error:', error);
                        });
                });
            </script>
        {% endblock %}